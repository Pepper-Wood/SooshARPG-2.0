<!DOCTYPE html>
<html lang="en">
<head>
    <title>Admin Dashboard</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link id="favicon" rel="shortcut icon" type="image/gif" href="http://rs858.pbsrc.com/albums/ab148/SuperNyappyOfLove/Kawaii%20Stuff/Pixels/068.gif~c200" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link href="http://materializecss.com/css/ghpages-materialize.css" rel="stylesheet">
    <link href="css/admin.css" rel="stylesheet">
</head>
<body>
    <div class="loginWrapper">
        <div class="loginSection z-depth-3">
            <h2>SooshARPG</h2>
            <p>Admin Dashboard</p>
            <input id="sooshPW" type="password" class="validate" placeholder="Password" style="margin-bottom:0">
            <p id="errorText" class="errorText">&nbsp;<span>The password you entered was incorrect</span>&nbsp;</p>
            <a id="sooshLoginButton" class="blockBtn waves-effect waves-light btn-large">Login</a>
        </div>
    </div>

    <ul id="navigation-tabs" class="tabs z-depth-1" data-scroll-header>
        <li class="tab col s3"><a class="active" href="#pepperFlag">Pepper's Notes</a></li>
        <li class="tab col s3"><a href="#dailiesRollerFlag">Dailies Roller</a></li>
        <li class="tab col s3"><a href="#villagePersonalityTestFlag">Village Personality Test</a></li>
    </ul>
    <div class="container">
        <div id="pepperFlag"></div>
        <div id="pepper" class="col s12 headerBuffer">
            <div class="card" style="padding:10px;">
                <h3>Pepper's Notes</h3>
                <p><a target="_blank" href="https://soosharpg.weebly.com/status-inflictions.html">url for status inflictions</a> All debuffs happen when a 1 is rolled; All buffs happen when a 20 is rolled.</p>
                <table>
                    <tr style="background-color:rgba(0,0,0,0.2)"><td>Buff/Debuff Name</td><td>Conditions it can be obtained</td></tr>
                    <tr><td>Lucky Duck</td><td>buff for Angling, Mining, Wood-Cutting, Gathering</td></tr>
                    <tr><td>Unlucky Duck</td><td>???</td></tr>
                    <tr><td>Lazy Bork</td><td>debuff for Crafting, Angling, Mining, Wood-Cutting, Gathering</td></tr>
                    <tr><td>Happy Camper</td><td>???</td></tr>
                    <tr><td>Spooked Pupper</td><td>debuff for if soosh is too low level going into a specific area</td></tr>
                    <tr><td>BEES!!!</td><td>debuff for Hunting</td></tr>
                    <tr><td>Strong Senses</td><td>???</td></tr>
                    <tr><td>Magic Paws</td><td>buff for Crafting</td></tr>
                    <tr><td>Lunar Moth</td><td>buff for Hunting</td></tr>
                </table>
                <ul>
                    <li><p>For other mods to provide answers:</p></li>
                    <li><b>- Please confirm the accuracy of the information in the above table</b></li>
                    <li><b>- What is the NEGATIVE STATUS for Companion Handling?</b></li>
                    <li><p>Pepper's To-Do</p></li>
                    <li>- Add flavortext for crafting along with image generation</li>
                    <li>- Add check for level when entering areas to determine spooky debuff</li>
                    <li>- Update the Admin Dashboard so that it is accurate</li>
                    <li>- Create prompt calculator</li>
                </ul>
            </div>
        </div>

        <div id="dailiesRollerFlag"></div>
        <div id="dailiesRoller" class="col s12 headerBuffer">
            <div class="card cardTile">
                <h3>Dailies Roller</h3>

                <div class="horizontalFlex flexGrow">
                    <div>
                        <label for="dailyType">Daily Type</label>
                        <select id="dailyType" class="browser-default">
                            <option>Crafting</option>
                            <option>Hunting</option>
                            <option>Angling</option>
                            <option>Mining</option>
                            <option>Wood-Cutting</option>
                            <option>Gathering</option>
                            <option>Cooking</option>
                            <option>Companion Handling</option>
                        </select>
                    </div>
                    <div>
                        <label for="locationType">Location</label>
                        <select id="locationType" class="browser-default">
                            <option>The Thickets</option>
                            <option>The Midwoods</option>
                            <option>The Thorns</option>
                            <option>Mount Solitude</option>
                            <option>Lake of Reflections</option>
                        </select>
                    </div>
                </div>

                <div class="input-field">
                    <input id="sooshName" type="text" list="sooshNames">
                    <datalist id="sooshNames"></datalist>
                    <label for="sooshName">User :: Soosh's Name</label>
                </div>
                <p id="sooshNameError" class="errorText">SooshARPG member not found. Please enter a valid name.</p>

                <div class="input-field">
                    <input id="inputItemName" type="text">
                    <label for="inputItemName">Crafting Item</label>
                </div>

                <div style="margin-top:20px">
                    <label for="inventoryBuff">Success Modifier</label>
                    <div id="inventoryBuff" class="horizontalFlex">
                        <button type="button" class="btn inactiveBtn waves-effect waves-light">-3</button>
                        <button type="button" class="btn inactiveBtn waves-effect waves-light">-2</button>
                        <button type="button" class="btn inactiveBtn waves-effect waves-light">-1</button>
                        <button type="button" class="btn inactiveBtn waves-effect waves-light activeBtn">0</button>
                        <button type="button" class="btn inactiveBtn waves-effect waves-light">+1</button>
                        <button type="button" class="btn inactiveBtn waves-effect waves-light">+2</button>
                        <button type="button" class="btn inactiveBtn waves-effect waves-light">+3</button>
                    </div>
                </div>
                <div class="card" style="margin-top:20px;padding:20px">
                    <div class="horizontalFlex">
                        <button id="rollDaily" type="button" class="blockBtn waves-effect waves-light btn">Roll Daily</button>
                        <button type="button" id="copyToClipboard" class="blockBtn waves-effect waves-light btn">Copy Result to Clipboard</button>
                        <button type="button" id="copyImgToClipboard" class="blockBtn waves-effect waves-light btn">Copy Thumbnail to Clipboard</button>
                    </div>

                    <label for="dailyOutput">Daily Result</label>
                    <textarea id="dailyOutput"></textarea>
                    <label for="thumbnailOutput">Thumbnail Result</label>
                    <textarea id="thumbnailOutput"></textarea>
                    <p id="copiedToClipboard" class="errorText">Copied Result to clipboard!</p>
                    <p id="copiedImgToClipboard" class="errorText">Copied Thumbnail to clipboard!</p>
                </div>
            </div>
        </div>

        <div id="villagePersonalityTestFlag"></div>
        <div id="villagePersonalityTest" class="col s12 headerBuffer">
            <div class="card cardTile">
                <h3>Village Personality Test</h3>
                <div class="horizontalFlex">
                    <div style="width:40%;">
                        <div id="personalityTestSection"></div>
                        <button type="button" id="sortingHat" class="blockBtn waves-effect waves-light btn">Calculate Village</button>
                    </div>
                    <div style="width:60%">
                        <div id="chartContainer"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>



    <!-- Javascript -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
    <script src="http://materializecss.com/bin/materialize.js"></script>
    <script src="js/smooth-scroll.js"></script>

    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script src="js/tabletop.js"></script>
    <script src="js/taffy.js"></script>
    <script src="http://www.kathryndipippo.com/SooshARPG/js/DAILIESDB.js"></script>
    <script src="js/adminInteractiveElements.js"></script>
    <script src="js/rollDaily.js"></script>
    <script>
    var public_spreadsheet_url = "https://docs.google.com/spreadsheets/d/1xUaU5i38rzwjQCs5RRwAQUIa6kpNcTFtlSSp_Tr80nE/edit?usp=sharing";
    var allSooshNames = [];
    var sooshARPGDirectory = TAFFY();
    var statExpLevels = TAFFY();
    var allItems = TAFFY();

    $("#sooshLoginButton").click(function(e) {
        handlePassword();
    });
    $("#sooshPW").keyup(function(e) {
        if (e.keyCode == 13) {
            handlePassword();
        }
    });
    $("#inventoryBuff>button").click(function() {
        $("#inventoryBuff>button").removeClass("activeBtn");
        $(this).addClass("activeBtn");
    });
    $("#sooshName").click(function() {
        $("#sooshNameError").slideUp();
    });
    $("#dailyType").change(function() {
        $("#inputItemName").val("");
        if ($("#dailyType option:selected").text() == "Crafting") {
            $("#inputItemName").next().text("Crafting Item");
            $("#inputItemName").parent().slideDown();
        } else if ($("#dailyType option:selected").text() == "Cooking") {
            $("#inputItemName").next().text("Cooking Item");
            $("#inputItemName").parent().slideDown();
        } else {
            $("#inputItemName").parent().slideUp();
        }
    });
    $("#rollDaily").click(function() {
        rollDaily();
    });

    function loadAdmin() {
        $("#sooshLoginButton").addClass("glowingAnimation");
        personalityTestSectionHTML = "";
        questionArray = ["A","B","C","D"];
        for (i=1; i<11; i++) {
            personalityTestSectionHTML += "<p><label>Question " + ('0' + i).slice(-2) + "</label>";
            for (j=0; j<questionArray.length; j++) {
                personalityTestSectionHTML += "<input name='question" + i + "' type='radio' id='question" + i + "" + questionArray[j] + "' value='" + questionArray[j] + "'><label for='question" + i + "" + questionArray[j] + "'>" + questionArray[j] + "</label>";
            }
            personalityTestSectionHTML += "</p>";
        }
        $("#personalityTestSection").html(personalityTestSectionHTML);
        Tabletop.init( { key: public_spreadsheet_url, callback: showInfo } );
    }

  function showInfo(data, tabletop) {
    $.each( tabletop.sheets("memberOverview").all(), function(i, soosh) {
      sooshARPGDirectory.insert({ "username":soosh.username,
                                  "status":soosh.status,
                                  "sooshName":soosh.sooshName,
                                  "sPronouns":soosh.sPronouns,
                                  "companionName":soosh.companionName,
                                  "cPronouns":soosh.cPronouns,
                                  "village":soosh.village,
                                  "appURL":soosh.appURL,
                                  "spreadsheetURL":soosh.spreadsheetURL,
                                  "totalExp":soosh.totalExp,
                                  "swirlSeeds":soosh.swirlSeeds,
                                  "achieveCount":soosh.achieveCount,
                                  "hotStreak":soosh.hotStreak
      });
    });
    $.each( tabletop.sheets("statExpLevels").all(), function(i, entry) {
        statExpLevels.insert({"id":parseInt(entry.id),
                              "level":entry.level,
                              "exp":parseInt(entry.exp),
                              "runningTotalExp":parseInt(entry.runningTotalExp),
                              "progress":entry.progress
        });
    });
    $.each( tabletop.sheets("allItems").all(), function(i, entry) {
      allItems.insert({"name":entry.name,
                       "smallImgUrl":entry.smallImgUrl,
                       "bigImgUrl":entry.bigImgUrl,
                       "thumbUrl":entry.thumbUrl,
                       "lifeSkill":entry.lifeSkill,
                       "description":entry.description,
                       "type":entry.type,
                       "rarity":entry.rarity,
                       "location":entry.location
      });
    });
    var datalistHTML = "";
    var sooshStr = "";
    sooshARPGDirectory().order("sooshName asec").each(function (soosh) {
      if ((soosh.sooshName != null) && (soosh.sooshName != "")) {
        sooshStr = soosh.username + " :: " + soosh.sooshName
        allSooshNames.push(sooshStr);
        datalistHTML += "<option value='" + sooshStr + "'>";
      }
    });
    $("#sooshNames").html(datalistHTML);
    $(".loginWrapper").animate({'marginTop' : "-=100%"},1000);
    $(".loginWrapper").fadeOut(1000);
  }
  </script>
</body>
</html>
